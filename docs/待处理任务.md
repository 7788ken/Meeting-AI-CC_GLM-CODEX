# meeting

## 底部增加快捷操作按钮并附上快捷键

1. 添加快捷键--切麦/闭麦

## 原文流模块

1. 语音转写返回的音频时长（.class="event-duration"）在刷新后不见了，应该是没有做数据持久化。
~~已处理~~

## 并发与链路同步（新增）
- [参考](./并发解决方案.md)
- [参考](./codex 审阅文档.md)
1. 采集中途错误需同步 stopTranscribe 与状态回滚，避免 UI 假录制。
**未处理**
2. 拆分窗口未命中 previousSentence 时需自动扩窗或触发重建，避免拆分停滞。
**未处理**
3. `GlmRateLimiter` 全局 + 桶双层排队导致有效并发下降，需评估调度策略。
**未处理**
4. 429 的 sleep 与 `GlmRateLimiter.onRateLimit` 双重退避叠加，需统一退避策略。
**未处理**
5. 分段调度并发控制与桶并发重复，等待任务占用 inFlight 导致吞吐下降。
**未处理**
6. 分段调度 session Map 无清理策略，长期运行存在内存增长风险。
**未处理**
7. `TRANSCRIPT_EVENTS_SEGMENT_MAX_PENDING_SESSIONS` / `TRANSCRIPT_EVENTS_SEGMENT_MAX_STALENESS_MS` 未纳入配置与文档，无法调优。
**未处理**
8. `GLM_TRANSCRIPT_SEGMENT_TRANSLATION_MODEL` 未在配置种子/设置页暴露，无法配置翻译模型。
**未处理**
9. 分析/翻译缺少会话级“最新任务覆盖”，旧任务可能长期占用队列。
**未处理**
10. 分段调度缺少 session 级公平调度与“最新任务覆盖”，可能导致活跃会话饥饿。
**未处理**
11. 并发与限流可观测性缺口：缺少队列长度/429 频率/耗时分布等指标。
**未处理**
12. 明确 AI 排队队列口径为 `global.queue + global.inFlight`（已确认：单实例口径），避免双层排队重复统计。
**未处理**
13. 后端暴露 AI 队列统计接口（含 `totalPending`、各桶 `queue/inFlight`、`instanceId`）。
**未处理**
14. 前端 header-right 展示“AI 排队队列数”（tooltip 标注 `queue + inFlight`、单实例口径、不含上游 pending）。
**未处理**
15. 移除/替换当前基于事件进度的“队列数”显示，避免误导。
**未处理**
16. 未授权/失败时 UI 降级策略（显示 `--` + 提示原因）。
**未处理**


1. 在录音后静音一段时间后，再次录音的时候不转写内容。
~~已处理~~
2. 数据入库的时候没有带上isFinal。
~~已处理~~
3. 音频累积时长要根据说话者的连贯性来动态改变。应该有一套算法。前端比如一直按 3 秒发送录音，后端进行拼接，当闭包或静音的时候进行转写，这样词句才会完整。比如：A 发言录制3S->3s-3s-3s,这是一个 12 秒完整的句子，应该进入同一条记录，而不是4 条记录。
~~已处理~~
4. 长语音依旧无法识别和转写。
~~已处理~~

## 语句拆分

1. 记录顺序倒置，新的内容在最上面
~~已处理~~
2. 当前的逻辑不对需要重构。首先语句拆分助手从transcript_events表中根据设定的窗口值（CHUNK_SIZE）获取数据上下文数据，整合规则，打包推送给语句拆分服务（GLM），返回结果保存到新的transcript_events_segments表中，供前端调用展示。
~~已处理~~
3. 语句拆分服务的工作核心：当被触发且得到上下文内容的时候，获取本会话中上一句的内容A，当前上下文内容内容B，交给 LLM 推理出下一句的内容C，并落库新记录C。 当再次触发的时候，获取本会话中上一句的内容C，当前上下文内容内容B1，交给 LLM 推理出下一句的内容D，并落库新记录D。——循环。（这样在前端就能够看到完整的对话内容。）
~~已处理~~
4. 前端语句拆分栏目中的事件#N-#N 数值好像不对，请检查。
~~已处理~~
5. 服务端加一道确定性兜底改为可配置开启或关闭。
~~已处理~~
6. 点击语句拆分的卡片，原文流自动滚动到相应的位置。
~~已处理~~
7. 语句拆分优化建议：语句拆分的时候通过 LLM 返回 识别当前语言类型，并落库。当语句拆分需要进行 LLM 翻译的时候，先进行一轮机器翻译，如果对比结果一致比如 ZHCN 和 ENG，则进行 LLM 翻译，否则不进行翻译。
**！暂不处理！**
8. 语句拆分标题栏应该有一个小型切换按钮，显示 原文/翻译，用来切换显示显示原文还是显示已翻译好的译文。
~~已处理~~
9. 语句拆分后的翻译流，翻译后的文本需要落库以便刷新后显示，并支持 8 的切换原文/译文功能。
~~已处理~~


1. 防抖优化建议：在点击同一个或不同的“针对性分析“按钮或“重拆“按钮或“重新分析“时，需进行全局防抖处理，避免重复点击，生成多个结果。
~~已处理~~

## 待讨论

1. `TranscriptGateway`（socket.io）与原生 WebSocket 并存，是否保留。
**待讨论**
2. `RecordButton` 是否仍有使用场景，是否移除。
**待讨论**

## 设置页面

1. 在数据库表app_configs 增加一个字段用户存储 系统安全密码，需要加密，默认为空，并且在前端settingsDrawer 设置中 的系统设置栏目内可以进行初始化或修改。该密码作用为设置了密码后，点击设置时需要验证码密码。修改本任务的时候，设置的相关API接口需要加验证。
~~已处理~~

2. 语言设置:可设置语句拆分翻译到语言“简体中文“或其他语言，可开关。可设置 AI 分析区的结果使用语言“简体中文“或其他语言，可开关。
~~已处理~~

3. 可设置的各项属性重新归类到各个配置中。比如AI 模型设置（ASR/LLM），转写设置，语句拆分设置(提示词和相关设置)，AI 分析设置(提示词和相关设置)，针对性分析设置，系统设置，客户端设置，语言设置，外观设置(可设置语音转写区字体大小/语句拆分区字体大小/AI 分析区字体大小)，日志记录设置(请求日志记录/错误日志记录/系统日志记录)，安全设置（设置中心管理密码/开启/关闭），等等。
~~已处理~~

4. 日志记录设置：增加开关记录日志按钮：请求与回复/错误/系统日志，并把对应日志落库到 app_logs 表中，并在会话调试台中增加相应的 tab 切换显示，备注只有在打开时候才记录。
**未处理**

5. 新建面板：“提示词管理“---用户可创建编辑保存-多套-自定义的提示词-可设默认/别名，并保存到数据库中；并将目前原有的 2 套提示词作为默认的“会议总结系统提示词“ 和 “分片总结系统提示词“提示词。     “AI 分析设置中的“会议总结系统提示词“ 和 “分片总结系统提示词“ 使用选择方式在“提示词库中（提示词管理）“中选择。
  5.1 提示词管理面板内容界面描述：该界面默认展示“提示词列表“并带有编辑或删除按钮，以及新增按钮。点击新增按钮，进入新增界面（此时应该看不到列表）且标题显示“新增提示词“，填写内容并保存，也可以取消新增。点击编辑按钮，进入编辑界面（此时应该看不到列表）且标题显示“编辑提示词“，填写内容并保存，也可以取消编辑。
~~已处理~~

6. 撤销客户端设置面板，将录音来源 和 服务地址 提高级别作为单独面板。
~~已处理~~


## 响应式

### 移动客户端

1. 语音转写区可视区域不够，需要调整。
2. AI 分析区可视区域不够，需要调整。
3. 侧边栏（设置和调试）在移动设备上的视觉体验不佳。
**未处理**


## 调试控制台
### 警告信息
1. MeetingView.vue:490 ElementPlusError: [el-radio] [API] label act as value is about to be deprecated in version 3.0.0, please use value instead.
For more detail, please visit: https://element-plus.org/en-US/component/radio.html
~~已处理~~



## 发布前准备
1. 对齐 docker 初始化脚本，SQL 脚本，Dockerfile，Docker-compose.yml，从本地数据库获取最新设置。

## 单机版重构
1. 使用本地数据库架构
