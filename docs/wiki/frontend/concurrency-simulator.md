# 并发调度模拟器

> 最后更新: 2026-01-17

## 目标

通过交互式页面解释并发请求在不同优先级下的排队与执行顺序，帮助团队快速理解：
- 多任务类型的权重调度如何影响实际顺序
- 会话级“最新任务覆盖”对排队位置的影响
- 并发工位与服务时长对吞吐与等待的影响

## 页面入口

- 路由：`/concurrency-simulator`
- 页面文件：`frontend/src/views/ConcurrencySimulatorView.vue`

## 模拟规则

1. **加权轮询**
   - 默认权重：ASR=4，拆分=3，翻译=2，分析=1。
   - 当某类任务无待处理项时，调度机会会让给其他类型。

2. **会话级最新任务覆盖**
   - 开启后，同一会话的旧任务会被最新任务覆盖，队列位置保持不变。
   - 关闭后使用 FIFO 排队（示意用途）。

3. **执行工位**
   - 工位为空闲时从队列取任务。
   - 服务时长以 tick 表示，便于观察节奏。

4. **队列口径**
   - 统计口径为 `pending + inFlight`，便于与后端“队列数”展示规则对齐。

## 关键交互

- **运行/暂停/单步推进**：在固定节奏下观察调度决策。
- **自动注入速率**：模拟多会话持续涌入请求。
- **手动插入**：在插入前展示“队列位置预览”，直观理解插队规则。
- **批量注入**：模拟突发流量和高峰场景。
- **切换会话合并**：切换模式会重置当前队列，避免模式混合导致误解。

## 插入位置说明

- **会话合并模式**：
  - 会话已在队列中 → 更新为最新任务，位置保持不变。
  - 会话不在队列中 → 追加至当前队列末尾。
- **FIFO 模式**：
  - 直接追加到队列末尾。

## 相关文档

- [并发解决方案](../../并发解决方案.md)
- [前端架构](./architecture.md)
